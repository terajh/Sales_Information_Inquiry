<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <link rel="icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="Web site created using create-react-app" />
    <link rel="stylesheet" href="templates/style/dropzone.css" />
    <link rel="stylesheet" href="templates/style/slider.css" />
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.4.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
    <script type="text/javascript" src="templates/javascript/dropzone.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.0.0/dist/tf.min.js"></script>
    <title>Humozaic</title>
    <link href="templates/static/css/2.1a02f21c.chunk.css" rel="stylesheet">
    <link href="templates/static/css/main.7327a5d9.chunk.css" rel="stylesheet">
</head>

<body><noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
    <script>!function (e) { function r(r) { for (var n, a, i = r[0], c = r[1], l = r[2], f = 0, s = []; f < i.length; f++)a = i[f], Object.prototype.hasOwnProperty.call(o, a) && o[a] && s.push(o[a][0]), o[a] = 0; for (n in c) Object.prototype.hasOwnProperty.call(c, n) && (e[n] = c[n]); for (p && p(r); s.length;)s.shift()(); return u.push.apply(u, l || []), t() } function t() { for (var e, r = 0; r < u.length; r++) { for (var t = u[r], n = !0, i = 1; i < t.length; i++) { var c = t[i]; 0 !== o[c] && (n = !1) } n && (u.splice(r--, 1), e = a(a.s = t[0])) } return e } var n = {}, o = { 1: 0 }, u = []; function a(r) { if (n[r]) return n[r].exports; var t = n[r] = { i: r, l: !1, exports: {} }; return e[r].call(t.exports, t, t.exports, a), t.l = !0, t.exports } a.e = function (e) { var r = [], t = o[e]; if (0 !== t) if (t) r.push(t[2]); else { var n = new Promise((function (r, n) { t = o[e] = [r, n] })); r.push(t[2] = n); var u, i = document.createElement("script"); i.charset = "utf-8", i.timeout = 120, a.nc && i.setAttribute("nonce", a.nc), i.src = function (e) { return a.p + "templates/static/js/" + ({}[e] || e) + "." + { 3: "dad64b0c" }[e] + ".chunk.js" }(e); var c = new Error; u = function (r) { i.onerror = i.onload = null, clearTimeout(l); var t = o[e]; if (0 !== t) { if (t) { var n = r && ("load" === r.type ? "missing" : r.type), u = r && r.target && r.target.src; c.message = "Loading chunk " + e + " failed.\n(" + n + ": " + u + ")", c.name = "ChunkLoadError", c.type = n, c.request = u, t[1](c) } o[e] = void 0 } }; var l = setTimeout((function () { u({ type: "timeout", target: i }) }), 12e4); i.onerror = i.onload = u, document.head.appendChild(i) } return Promise.all(r) }, a.m = e, a.c = n, a.d = function (e, r, t) { a.o(e, r) || Object.defineProperty(e, r, { enumerable: !0, get: t }) }, a.r = function (e) { "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, { value: "Module" }), Object.defineProperty(e, "__esModule", { value: !0 }) }, a.t = function (e, r) { if (1 & r && (e = a(e)), 8 & r) return e; if (4 & r && "object" == typeof e && e && e.__esModule) return e; var t = Object.create(null); if (a.r(t), Object.defineProperty(t, "default", { enumerable: !0, value: e }), 2 & r && "string" != typeof e) for (var n in e) a.d(t, n, function (r) { return e[r] }.bind(null, n)); return t }, a.n = function (e) { var r = e && e.__esModule ? function () { return e.default } : function () { return e }; return a.d(r, "a", r), r }, a.o = function (e, r) { return Object.prototype.hasOwnProperty.call(e, r) }, a.p = "/", a.oe = function (e) { throw console.error(e), e }; var i = this["webpackJsonpmy-app"] = this["webpackJsonpmy-app"] || [], c = i.push.bind(i); i.push = r, i = i.slice(); for (var l = 0; l < i.length; l++)r(i[l]); var p = c; t() }([])</script>
    <script src="templates/static/js/2.1e8c772f.chunk.js"></script>
    <script src="templates/static/js/main.c30afe7b.chunk.js"></script>
</body>
<script>var _pos_x, _pos_y, ratio, TILE_HEIGHT = 10, TILE_WIDTH = 10, current_image_id = null, slider_value = [1, 2, 3, 5, 6, 9, 10, 15, 18, 27]; $(window).load(() => { const t = document.querySelector("#jsCanvas"), e = t.getContext("2d"), a = (document.querySelector(".browse-btn"), document.querySelector("#real-input")); document.querySelector("#down_images").addEventListener("click", () => { var t = document.querySelector("#jsCanvas").toDataURL("image/png"); t = (t = t.replace(/^data:image\/[^;]*/, "data:application/octet-stream")).replace(/^data:application\/octet-stream/, "data:application/octet-stream;headers=Content-Disposition%3A%20attachment%3B%20filename=Canvas.png"); var e = document.createElement("a"); e.download = "mozaic.png", e.href = t, e.click() }), a.addEventListener("change", (function (a) { var r = a.target.files, o = new FileReader; o.onload = function (a) { var o = new Image; o.onload = function () { o, ratio = 730 / o.height, console.log(o.height, ratio), t.width = o.width * ratio, t.height = o.height * ratio, e.drawImage(o, 0, 0, t.width, t.height); var a = new FormData; a.append("uploadFile", r[0]), a.append("name", "test"), $("body").toggleClass("loading"), $.ajax({ url: "/api", data: a, processData: !1, contentType: !1, type: "POST", headers: { "Access-Control-Allow-Credentials": !0, "Access-Control-Allow-Origin": "*", "Access-Control-Allow-Methods": "GET", "Access-Control-Allow-Headers": "application/json" }, success: function (t) { console.log(t), $("body").toggleClass("loading"); for (var a = [], r = [], i = 0; i < t.len; i++)a.push(t.list[i].left), a.push(t.list[i].right), r.push(t.list[i].top), r.push(t.list[i].bottom); console.log(a, r), _pos_x = a, _pos_y = r; var n = $("#select_mozaic_human"); for (i = 0; i < a.length; i += 2) { var c = document.createElement("div"); c.className = "face_div"; var d = document.createElement("input"); d.className = "check_face display_none", d.id = "radio" + i.toString(), d.type = "radio"; var s = document.createElement("canvas"); s.className = "face_canvas", s.id = "canvas" + i.toString(), s.setAttribute("x", a[i]), s.setAttribute("y", r[i]), s.setAttribute("dx", a[i + 1] - a[i]), s.setAttribute("dy", r[i + 1] - r[i]), s.getContext("2d").drawImage(o, a[i], r[i], a[i + 1] - a[i], r[i + 1] - r[i], 0, 0, s.width, s.height), c.append(d), c.append(s), n.append(c), s.addEventListener("click", t => { var a = new Image; if (console.log("click"), "true" !== $("#radio" + t.target.id.split("canvas")[1]).attr("check")) { $("#" + t.target.id).toggleClass("face_canvas_select"), $("#radio" + t.target.id.split("canvas")[1]).prop("checked", !0), $("#radio" + t.target.id.split("canvas")[1]).attr("check", !0); var r = document.querySelector("#" + t.target.id).toDataURL("image/ipeg"); current_image_id = t.target.id; var o = document.querySelector("#" + t.target.id).getContext("2d"), i = document.querySelector("#previewCanvas"); i.getContext("2d").drawImage(o.canvas, 0, 0, i.width, i.height), a.onload = function (t) { var e = document.querySelector("#" + current_image_id), a = e.getAttribute("x"), r = e.getAttribute("y"), o = e.getAttribute("dx"), i = e.getAttribute("dy"); photomosaic(t.path[0], a * ratio, r * ratio, o * ratio, i * ratio) }, a.src = r } else { $("#" + t.target.id).toggleClass("face_canvas_select"), $("#radio" + t.target.id.split("canvas")[1]).prop("checked", !1), $("#radio" + t.target.id.split("canvas")[1]).attr("check", !1); let a = document.querySelector("#" + t.target.id), r = a.getContext("2d"); var n = a.getAttribute("x") * ratio, c = a.getAttribute("y") * ratio, d = a.getAttribute("dx") * ratio, s = a.getAttribute("dy") * ratio; e.drawImage(r.canvas, 0, 0, r.canvas.width, r.canvas.height, n, c, d, s) } }) } } }) }, o.src = a.target.result }, o.readAsDataURL(r[0]) })) }); var slider = document.getElementById("myRange"), output = document.getElementById("demo"); function photomosaic(t, e = -1, a = -1, r = -1, o = -1) { var i = TILE_WIDTH, n = TILE_HEIGHT, c = document.querySelector("#previewCanvas"), d = c.getContext("2d"), s = d.getImageData(0, 0, c.width, c.height), l = s.data, g = c.width / i, u = c.height / n; function m(t, e) { var a, r, o = -4, i = { r: 0, g: 0, b: 0 }, n = 0; try { a = d.getImageData(e * TILE_WIDTH, t * TILE_HEIGHT, TILE_HEIGHT, TILE_WIDTH) } catch (t) { return alert("Not happening this time!"), i } for (r = a.data.length; (o += 4) < r;)++n, i.r += a.data[o], i.g += a.data[o + 1], i.b += a.data[o + 2]; return i.r = ~~(i.r / n), i.g = ~~(i.g / n), i.b = ~~(i.b / n), i } for (var v = 0; v < u; v++)for (var h = 0; h < g; h++)for (var p = m(v, h), _ = p.r, y = p.g, w = p.b, I = 0; I < n; I++)for (var f = 0; f < i; f++) { var b = h * i + f, A = (v * n + I) * (4 * s.width) + 4 * b; l[A + 0] = _, l[A + 1] = y, l[A + 2] = w, l[A + 3] = 255 } if (d.putImageData(s, 0, 0), -1 != e) { document.querySelector("#jsCanvas").getContext("2d").drawImage(d.canvas, 0, 0, d.canvas.width, d.canvas.height, e, a, r, o) } return c } $("#myRange").attr("value", "50"), slider.max = 10, slider.value = 5, (slider = document.getElementById("myRange")).oninput = function () { var t = new Image, e = document.querySelector("#" + current_image_id).toDataURL("image/ipeg"), a = document.querySelector("#" + current_image_id).getContext("2d"), r = document.querySelector("#previewCanvas"), o = r.getContext("2d"); o.clearRect(0, 0, r.width, r.height), o.drawImage(a.canvas, 0, 0, r.width, r.height), TILE_HEIGHT = slider_value[slider.value - 1], TILE_WIDTH = slider_value[slider.value - 1], t.onload = function () { var e = document.querySelector("#" + current_image_id), a = e.getAttribute("x"), r = e.getAttribute("y"), o = e.getAttribute("dx"), i = e.getAttribute("dy"); photomosaic(t, a * ratio, r * ratio, o * ratio, i * ratio) }, t.src = e }</script>

</html>